name: Local Languages Survey 2023 GitHub Actions workflow

on:
  issues:
    types: [opened, edited]

jobs:
  issue_opened_edited:
    runs-on: ubuntu-latest

    steps:
      - name: Print issue details
        run: echo "Gotcha issue ${{ github.event.issue.labels[0].name }}"
        env:
          LABELS: ${{ github.event.issue.labels[0].name }}

      - name: Checkout so that we have the Python script in the container
        uses: actions/checkout@v2
        with:
          repository: pavankumar0077/Local-Language-for-Workflows
          token: ${{ secrets.GIT_TOKEN }}

      - name: View the GitHub context
        run: echo "$GITHUB_CONTEXT" >> ${{ env.SCRIPTS_DIR }}/issue.out
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
          SCRIPTS_DIR: ${{ secrets.SCRIPTS_DIR }}

      - name: Push to Neo4j
        run: |
          python -m pip install --upgrade pip
          pip install neo4j
          python ${{ secrets.SCRIPTS_DIR }}/PushRecordToNeo4j.py
        env:
          NEO4J_URL: ${{ secrets.NEO4J_URL }}
          NEO4J_USER: ${{ secrets.NEO4J_USER }}
          NEO4J_PASSWD: ${{ secrets.NEO4J_PASSWD }}
          SCRIPTS_DIR: ${{ secrets.SCRIPTS_DIR }}
          MY_ISSUE_LABEL: ${{ secrets.MY_ISSUE_LABEL }}
